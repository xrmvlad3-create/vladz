<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <title>IzaManagement – Previzualizare cod</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="preconnect" href="https://fonts.bunny.net">
  <link href="https://fonts.bunny.net/css?family=instrument-sans:400,500,600" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <style>
    :root{--bg:#0b0b0c;--panel:#101113;--muted:#9aa0a6;--primary:#f97316;--border:#24262a;--text:#e7eaee;--link:#60a5fa}
    *{box-sizing:border-box}
    html,body{margin:0;height:100%}
    body{display:flex;flex-direction:column;background:var(--bg);color:var(--text);font-family:'Instrument Sans',ui-sans-serif,system-ui,sans-serif}
    header{display:flex;align-items:center;gap:12px;padding:16px 20px;border-bottom:1px solid var(--border)}
    header .brand{font-weight:600}
    header a{color:var(--link);text-decoration:none}
    .wrap{flex:1;display:flex;min-height:0}
    nav{width:300px;border-right:1px solid var(--border);padding:16px;background:var(--panel);overflow:auto}
    nav h3{margin:0 0 8px;font-size:14px;color:var(--muted)}
    .file{display:flex;gap:8px;align-items:center;padding:8px 10px;border-radius:6px;cursor:pointer;color:var(--text)}
    .file:hover{background:#15171a}
    .file.active{background:#171a1f;border:1px solid #1f2937}
    .file small{color:var(--muted)}
    main{flex:1;display:flex;flex-direction:column;min-width:0}
    .topbar{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);padding:10px 16px;background:var(--panel)}
    .topbar .title{font-size:14px;color:var(--muted)}
    .code{flex:1;min-height:0;overflow:auto;padding:0}
    pre{margin:0;padding:16px}
    .hint{padding:8px 16px;color:var(--muted);border-bottom:1px solid var(--border)}
    .badge{display:inline-block;padding:2px 8px;border-radius:999px;background:#13243a;color:#7dc1ff;border:1px solid #1f3b5e;font-size:12px}
    .links{display:flex;gap:12px;align-items:center}
    .links a{color:var(--link)}
    footer{padding:12px 16px;color:var(--muted);border-top:1px solid var(--border);font-size:12px}
    @media (max-width: 960px){nav{width:220px}}
  </style>
</head>
<body>
  <header>
    <div class="brand">IzaManagement – Previzualizare cod</div>
    <div class="links">
      <a href="./index.html">Previzualizare UI statică</a>
    </div>
  </header>
  <div class="wrap">
    <nav id="sidebar">
      <h3>Fișiere cheie</h3>
      <div class="file" data-file="Dockerfile">Dockerfile <small>· Build PHP + Vite</small></div>
      <div class="file" data-file="docker-compose.preview.yml">docker-compose.preview.yml <small>· Stack de previzualizare</small></div>
      <div class="file" data-file="docker-compose.yml">docker-compose.yml <small>· Stack complet</small></div>
      <div class="file" data-file="docker/nginx/preview.conf">docker/nginx/preview.conf <small>· Nginx (HTTP)</small></div>
      <div class="file" data-file="scripts/preview.sh">scripts/preview.sh <small>· Bootstrap Unix</small></div>
      <div class="file" data-file="scripts/preview.ps1">scripts/preview.ps1 <small>· Bootstrap Windows</small></div>
      <div class="file" data-file="vite.config.js">vite.config.js</div>
      <div class="file" data-file="package.json">package.json</div>
      <div class="file" data-file="composer.json">composer.json</div>
      <div class="file" data-file="routes/web.php">routes/web.php</div>
      <div class="file" data-file="resources/views/welcome.blade.php">resources/views/welcome.blade.php</div>
    </nav>
    <main>
      <div class="topbar">
        <div class="title" id="filename">Dockerfile</div>
        <div><span class="badge" id="lang">dockerfile</span></div>
      </div>
      <div class="hint">Selectează un fișier din stânga pentru a vedea codul. Evidențierea sintaxei este activă.</div>
      <div class="code">
        <pre><code id="code" class="language-dockerfile"></code></pre>
      </div>
    </main>
  </div>
  <footer>Pont: pentru o previzualizare runtime locală, folosește scripts/preview.ps1 (Windows) sau scripts/preview.sh (macOS/Linux) cu Docker.</footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>
    const files = {
      "Dockerfile": { lang: "dockerfile", content: `FROM php:8.2-fpm-alpine

# Set working directory
WORKDIR /var/www/html

# Install system dependencies
RUN apk add --no-cache \
    git \
    curl \
    libpng-dev \
    libxml2-dev \
    zip \
    unzip \
    postgresql-dev \
    oniguruma-dev \
    nodejs \
    npm \
    supervisor \
    nginx

# Install PHP extensions
RUN docker-php-ext-install \
    pdo \
    pdo_pgsql \
    mbstring \
    exif \
    pcntl \
    bcmath \
    gd \
    xml \
    soap \
    intl \
    zip

# Install Redis extension
RUN apk add --no-cache --virtual .build-deps $PHPIZE_DEPS \
    && pecl install redis \
    && docker-php-ext-enable redis \
    && apk del .build-deps

# Get latest Composer
COPY --from=composer:latest /usr/bin/composer /usr/bin/composer

# Create system user to run Composer and Artisan Commands
RUN addgroup -g 1000 www && \
    adduser -u 1000 -G www -s /bin/sh -D www

# Copy existing application directory contents
COPY . /var/www/html

# Copy existing application directory permissions
COPY --chown=www:www . /var/www/html

# Install dependencies
USER www
# Ensure .env exists for artisan commands during build
RUN php -r "file_exists('.env') || copy('.env.production', '.env');"
RUN composer install --no-dev --optimize-autoloader
# Generate application key for .env
RUN php artisan key:generate --ansi || true
# Build frontend assets (use npm ci if lockfile exists, otherwise install)
RUN npm ci || npm install
RUN npm run build

# Switch back to root for service configuration
USER root

# Configure PHP
COPY docker/php/local.ini /usr/local/etc/php/conf.d/local.ini
COPY docker/php/php-fpm.conf /usr/local/etc/php-fpm.d/www.conf

# Configure Supervisor
COPY docker/supervisor/supervisord.conf /etc/supervisor/conf.d/supervisord.conf

# Set permissions
RUN chown -R www:www /var/www/html \
    && chmod -R 755 /var/www/html/storage \
    && chmod -R 755 /var/www/html/bootstrap/cache

# Create Laravel storage symlink
RUN php artisan storage:link || true

# Expose port 9000 and start php-fpm server
EXPOSE 9000

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD php artisan tinker --execute="echo 'OK';" || exit 1

CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]` },
      "docker-compose.preview.yml": { lang: "yaml", content: `version: '3.8'

services:
  # Laravel Application (PHP-FPM)
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-app-preview
    restart: unless-stopped
    working_dir: /var/www/html
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - DB_CONNECTION=pgsql
      - DB_HOST=postgres
      - DB_PORT=5432
      - DB_DATABASE=izamanagement
      - DB_USERNAME=izauser
      - DB_PASSWORD=secure_password_2025
      - REDIS_HOST=redis
      - QUEUE_CONNECTION=redis
      - CACHE_DRIVER=redis
      - SESSION_DRIVER=redis
    networks:
      - izamanagement-preview
    depends_on:
      - postgres
      - redis

  # Nginx Web Server (HTTP only for preview)
  nginx:
    image: nginx:1.25-alpine
    container_name: izamanagement-nginx-preview
    restart: unless-stopped
    ports:
      - "8080:80"
    volumes:
      - ./:/var/www/html:ro
      - ./docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./docker/nginx/preview.conf:/etc/nginx/conf.d/default.conf:ro
      - nginx-logs-preview:/var/log/nginx
    networks:
      - izamanagement-preview
    depends_on:
      - app

  # PostgreSQL Database
  postgres:
    image: postgres:15-alpine
    container_name: izamanagement-postgres-preview
    restart: unless-stopped
    environment:
      - POSTGRES_DB=izamanagement
      - POSTGRES_USER=izauser
      - POSTGRES_PASSWORD=secure_password_2025
      - POSTGRES_INITDB_ARGS=--encoding=UTF-8 --lc-collate=C --lc-ctype=C
    volumes:
      - postgres-data-preview:/var/lib/postgresql/data
      - ./docker/postgres/init:/docker-entrypoint-initdb.d
    ports:
      - "5432:5432"
    networks:
      - izamanagement-preview

  # Redis Cache & Queue
  redis:
    image: redis:7-alpine
    container_name: izamanagement-redis-preview
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis-data-preview:/data
      - ./docker/redis/redis.conf:/etc/redis/redis.conf:ro
    command: redis-server /etc/redis/redis.conf
    networks:
      - izamanagement-preview

  # Queue Worker
  queue-worker:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-queue-preview
    restart: unless-stopped
    working_dir: /var/www/html
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - DB_CONNECTION=pgsql
      - DB_HOST=postgres
      - DB_PORT=5432
      - DB_DATABASE=izamanagement
      - DB_USERNAME=izauser
      - DB_PASSWORD=secure_password_2025
      - REDIS_HOST=redis
      - QUEUE_CONNECTION=redis
      - CACHE_DRIVER=redis
      - SESSION_DRIVER=redis
    command: php artisan queue:work --tries=3 --max-time=3600
    networks:
      - izamanagement-preview
    depends_on:
      - app
      - postgres
      - redis

  # Scheduler
  scheduler:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-scheduler-preview
    restart: unless-stopped
    working_dir: /var/www/html
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - DB_CONNECTION=pgsql
      - DB_HOST=postgres
      - DB_PORT=5432
      - DB_DATABASE=izamanagement
      - DB_USERNAME=izauser
      - DB_PASSWORD=secure_password_2025
    command: >
      sh -c "while true; do
        php artisan schedule:run --verbose --no-interaction &
        sleep 60
      done"
    networks:
      - izamanagement-preview
    depends_on:
      - app
      - postgres

volumes:
  postgres-data-preview:
    driver: local
  redis-data-preview:
    driver: local
  nginx-logs-preview:
    driver: local

networks:
  izamanagement-preview:
    driver: bridge` },
      "docker-compose.yml": { lang: "yaml", content: `version: '3.8'

services:
  # Laravel Application
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-app
    restart: unless-stopped
    working_dir: /var/www/html
    volumes:
      - ./:/var/www/html
      - ./storage/app:/var/www/html/storage/app
      - ./storage/logs:/var/www/html/storage/logs
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - DB_CONNECTION=pgsql
      - DB_HOST=postgres
      - DB_PORT=5432
      - DB_DATABASE=izamanagement
      - DB_USERNAME=izauser
      - DB_PASSWORD=secure_password_2025
      - REDIS_HOST=redis
      - QUEUE_CONNECTION=redis
      - CACHE_DRIVER=redis
      - SESSION_DRIVER=redis
      - GROQ_API_KEY=\${GROQ_API_KEY}
      - OLLAMA_BASE_URL=http://ollama:11434
    networks:
      - izamanagement-network
    depends_on:
      - postgres
      - redis
      - ollama

  # Nginx Web Server
  nginx:
    image: nginx:1.25-alpine
    container_name: izamanagement-nginx
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./:/var/www/html:ro
      - ./docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./docker/nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - ./docker/ssl:/etc/nginx/ssl:ro
      - nginx-logs:/var/log/nginx
    networks:
      - izamanagement-network
    depends_on:
      - app

  # PostgreSQL Database
  postgres:
    image: postgres:15-alpine
    container_name: izamanagement-postgres
    restart: unless-stopped
    environment:
      - POSTGRES_DB=izamanagement
      - POSTGRES_USER=izauser
      - POSTGRES_PASSWORD=secure_password_2025
      - POSTGRES_INITDB_ARGS=--encoding=UTF-8 --lc-collate=C --lc-ctype=C
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - ./docker/postgres/init:/docker-entrypoint-initdb.d
    ports:
      - "5432:5432"
    networks:
      - izamanagement-network
    command: >
      postgres
      -c max_connections=200
      -c shared_buffers=256MB
      -c effective_cache_size=1GB
      -c maintenance_work_mem=64MB
      -c checkpoint_completion_target=0.9
      -c wal_buffers=16MB
      -c default_statistics_target=100
      -c random_page_cost=1.1
      -c effective_io_concurrency=200

  # Redis Cache & Queue
  redis:
    image: redis:7-alpine
    container_name: izamanagement-redis
    restart: unless-stopped
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
      - ./docker/redis/redis.conf:/etc/redis/redis.conf:ro
    command: redis-server /etc/redis/redis.conf
    networks:
      - izamanagement-network

  # Ollama AI Service (Local)
  ollama:
    image: ollama/ollama:latest
    container_name: izamanagement-ollama
    restart: unless-stopped
    ports:
      - "11434:11434"
    volumes:
      - ollama-data:/root/.ollama
    environment:
      - OLLAMA_ORIGINS=*
      - OLLAMA_HOST=0.0.0.0
    networks:
      - izamanagement-network
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  # Queue Worker
  queue-worker:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-queue
    restart: unless-stopped
    working_dir: /var/www/html
    volumes:
      - ./:/var/www/html
    environment:
      - APP_ENV=production
      - DB_HOST=postgres
      - REDIS_HOST=redis
    command: php artisan queue:work --tries=3 --max-time=3600
    networks:
      - izamanagement-network
    depends_on:
      - postgres
      - redis

  # Scheduler
  scheduler:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: izamanagement-scheduler
    restart: unless-stopped
    working_dir: /var/www/html
    volumes:
      - ./:/var/www/html
    environment:
      - APP_ENV=production
      - DB_HOST=postgres
    command: >
      sh -c "while true; do
        php artisan schedule:run --verbose --no-interaction &
        sleep 60
      done"
    networks:
      - izamanagement-network
    depends_on:
      - postgres

  # Elasticsearch (for full-text search)
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    container_name: izamanagement-elasticsearch
    restart: unless-stopped
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    volumes:
      - elasticsearch-data:/usr/share/elasticsearch/data
    ports:
      - "9200:9200"
    networks:
      - izamanagement-network

  # Monitoring with Grafana
  grafana:
    image: grafana/grafana:latest
    container_name: izamanagement-grafana
    restart: unless-stopped
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin2025
      - GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource
    volumes:
      - grafana-data:/var/lib/grafana
      - ./docker/grafana/provisioning:/etc/grafana/provisioning
    ports:
      - "3000:3000"
    networks:
      - izamanagement-network

  # Prometheus (metrics collection)
  prometheus:
    image: prom/prometheus:latest
    container_name: izamanagement-prometheus
    restart: unless-stopped
    volumes:
      - ./docker/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      - prometheus-data:/prometheus
    ports:
      - "9090:9090"
    networks:
      - izamanagement-network

  # Backup Service
  backup:
    image: postgres:15-alpine
    container_name: izamanagement-backup
    restart: unless-stopped
    volumes:
      - ./backups:/backups
      - ./docker/backup/backup.sh:/backup.sh:ro
    environment:
      - PGPASSWORD=secure_password_2025
    command: >
      sh -c "while true; do
        sleep 86400 # 24 hours
        /backup.sh
      done"
    networks:
      - izamanagement-network
    depends_on:
      - postgres

volumes:
  postgres-data:
    driver: local
  redis-data:
    driver: local
  ollama-data:
    driver: local
  elasticsearch-data:
    driver: local
  grafana-data:
    driver: local
  prometheus-data:
    driver: local
  nginx-logs:
    driver: local

networks:
  izamanagement-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/16` },
      "docker/nginx/preview.conf": { lang: "nginx", content: `server {
    listen 80;
    server_name localhost;
    root /var/www/html/public;
    index index.php index.html;

    access_log /var/log/nginx/izamanagement.access.log main;
    error_log /var/log/nginx/izamanagement.error.log;

    # Laravel front controller
    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    # PHP-FPM
    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass php;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
        fastcgi_read_timeout 120;
        fastcgi_send_timeout 120;
    }

    # Static assets
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|woff2?|ttf|eot|svg)$ {
        expires 7d;
        add_header Cache-Control "public, max-age=604800";
        try_files $uri =404;
    }

    # Health check
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}` },
      "scripts/preview.sh": { lang: "bash", content: `#!/usr/bin/env bash
set -euo pipefail

COMPOSE="docker compose -f docker-compose.preview.yml"

echo "[preview] Building and starting containers..."
$COMPOSE up -d --build

echo "[preview] Waiting for Postgres readiness..."
for i in {1..30}; do
  if $COMPOSE exec -T postgres pg_isready -U izauser -d izamanagement >/dev/null 2>&1; then
    echo "[preview] Postgres is ready."
    break
  fi
  sleep 2
  if [ "$i" -eq 30 ]; then
    echo "[preview] Postgres not ready after waiting. Proceeding anyway."
  fi
done

echo "[preview] Running Laravel setup (non-fatal if already set)..."
$COMPOSE exec -T app php artisan key:generate || true
$COMPOSE exec -T app php artisan config:cache || true
$COMPOSE exec -T app php artisan route:cache || true
$COMPOSE exec -T app php artisan view:cache || true
$COMPOSE exec -T app php artisan migrate --force || true
$COMPOSE exec -T app php artisan db:seed --force || true
$COMPOSE exec -T app php artisan storage:link || true

echo
echo "Preview is up:"
echo "  App URL:  http://localhost:8080"
echo "  Health:   curl http://localhost:8080/health"
echo
$COMPOSE ps` },
      "scripts/preview.ps1": { lang: "powershell", content: `# IzaManagement - Windows Preview Bootstrap (PowerShell)
# Runs the full preview stack: app, nginx, postgres, redis, queue, scheduler
# Usage:
#   - In PowerShell (Run as admin or user):
#       Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
#       .\\scripts\\preview.ps1

Set-StrictMode -Version Latest
$ErrorActionPreference = 'Stop'

# Choose compose command (new vs legacy)
$composeBase = "docker compose"
try { & docker compose version | Out-Null } catch { $composeBase = "docker-compose" }
$compose = "$composeBase -f docker-compose.preview.yml"

Write-Host "[preview] Building and starting containers..." -ForegroundColor Cyan
& $composeBase -v | Out-Null
& $compose up -d --build

Write-Host "[preview] Waiting for Postgres readiness..." -ForegroundColor Cyan
$postgresReady = $false
for ($i = 1; $i -le 30; $i++) {
    try {
        & $compose exec -T postgres pg_isready -U izauser -d izamanagement | Out-Null
        $postgresReady = $true
        break
    } catch {
        Start-Sleep -Seconds 2
    }
}
if ($postgresReady) {
    Write-Host "[preview] Postgres is ready." -ForegroundColor Green
} else {
    Write-Host "[preview] Postgres not ready after waiting. Proceeding anyway." -ForegroundColor Yellow
}

function Run-Artisan($args) {
    try {
        & $compose exec -T app php artisan $args
    } catch {
        Write-Host "[preview] artisan $args (non-fatal error, continuing)" -ForegroundColor Yellow
    }
}

Write-Host "[preview] Running Laravel setup..." -ForegroundColor Cyan
Run-Artisan "key:generate"
Run-Artisan "config:cache"
Run-Artisan "route:cache"
Run-Artisan "view:cache"
Run-Artisan "migrate --force"
Run-Artisan "db:seed --force"
Run-Artisan "storage:link"

Write-Host ""
Write-Host "Preview is up:" -ForegroundColor Green
Write-Host "  App URL:  http://localhost:8080"
Write-Host "  Health:   curl http://localhost:8080/health"
Write-Host ""
& $compose ps` },
      "vite.config.js": { lang: "javascript", content: `import { defineConfig } from 'vite';
import laravel from 'laravel-vite-plugin';
import tailwindcss from '@tailwindcss/vite';

export default defineConfig({
    plugins: [
        laravel({
            input: ['resources/css/app.css', 'resources/js/app.js'],
            refresh: true,
        }),
        tailwindcss(),
    ],
});` },
      "package.json": { lang: "json", content: `{
    "$schema": "https://json.schemastore.org/package.json",
    "private": true,
    "type": "module",
    "scripts": {
        "build": "vite build",
        "dev": "vite"
    },
    "devDependencies": {
        "@tailwindcss/vite": "^4.0.0",
        "axios": "^1.11.0",
        "concurrently": "^9.0.1",
        "laravel-vite-plugin": "^2.0.0",
        "tailwindcss": "^4.0.0",
        "vite": "^7.0.4"
    }
}` },
      "composer.json": { lang: "json", content: `{
    "name": "izamanagement/platform",
    "description": "IzaManagement - Medical AI platform (Laravel 11, PHP 8.2+)",
    "type": "project",
    "license": "MIT",
    "keywords": [
        "laravel",
        "php",
        "medical",
        "ai",
        "education"
    ],
    "require": {
        "php": "^8.2",
        "guzzlehttp/guzzle": "^7.8",
        "laravel/framework": "^11.0",
        "laravel/sanctum": "^4.0",
        "laravel/scout": "^10.0",
        "laravel/tinker": "^2.9",
        "spatie/laravel-permission": "^6.0"
    },
    "require-dev": {
    },
    "autoload": {
        "psr-4": {
            "App\\\\": "app/",
            "Database\\\\Factories\\\\": "database/factories/",
            "Database\\\\Seeders\\\\": "database/seeders/"
        }
    },
    "scripts": {
        "post-autoload-dump": [
            "@php artisan package:discover --ansi"
        ],
        "post-root-package-install": [
            "@php -r \\"file_exists('.env') || copy('.env.production', '.env');\\""
        ],
        "post-create-project-cmd": [
            "@php artisan key:generate --ansi"
        ]
    },
    "extra": {
        "laravel": {
            "dont-discover": []
        }
    },
    "minimum-stability": "stable",
    "prefer-stable": true
}` },
      "routes/web.php": { lang: "php", content: `<?php

use Illuminate\\Support\\Facades\\Route;

Route::get('/', function () {
    return view('welcome');
});` },
      "resources/views/welcome.blade.php": { lang: "html", content: `<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{{ config('app.name', 'Laravel') }}</title>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.bunny.net">
        <link href="https://fonts.bunny.net/css?family=instrument-sans:400,500,600" rel="stylesheet" />

        <!-- Styles / Scripts -->
        @if (file_exists(public_path('build/manifest.json')) || file_exists(public_path('hot')))
            @vite(['resources/css/app.css', 'resources/js/app.js'])
        @else
            <style>
                /*! tailwindcss v4.0.7 | MIT License | https://tailwindcss.com */ /* truncated for brevity in preview */
            </style>
        @endif
    </head>
    <body class="bg-[#FDFDFC] dark:bg-[#0a0a0a] text-[#1b1b18] flex p-6 lg:p-8 items-center lg:justify-center min-h-screen flex-col">
        <!-- Welcome content ... -->
    </body>
</html>` }
    };

    const sidebar = document.getElementById('sidebar');
    const codeEl = document.getElementById('code');
    const filenameEl = document.getElementById('filename');
    const langEl = document.getElementById('lang');

    function renderFile(name) {
      const item = files[name];
      filenameEl.textContent = name;
      langEl.textContent = item.lang;

      codeEl.className = '';
      codeEl.classList.add('language-' + item.lang);
      codeEl.textContent = item.content;

      document.querySelectorAll('.file').forEach(el => el.classList.remove('active'));
      const active = document.querySelector('.file[data-file="'+name+'"]');
      if (active) active.classList.add('active');

      // highlight
      hljs.highlightElement(codeEl);
    }

    // Click bindings
    document.querySelectorAll('.file').forEach(el => {
      el.addEventListener('click', () => renderFile(el.getAttribute('data-file')));
    });

    // Initial
    renderFile('Dockerfile');
  </script>
</body>
</html>